<p-toast></p-toast>
<div class="register-container">
  <div class="register-background">
    <div class="background-pattern"></div>
    <div class="floating-elements">
      <div class="element element-1"></div>
      <div class="element element-2"></div>
      <div class="element element-3"></div>
    </div>
  </div>

  <div class="register-content" [ngClass]="{'mobile-layout': isMobile}">
    <div class="register-card fade-in-up">

      <div class="register-header">
        <div class="logo-section">
          <img src="https://i.postimg.cc/RZNyjZGf/tomate-ritmo-logo-removebg-preview.png"
               alt="TomateRitmo"
               class="logo">
        </div>

        <div class="header-text">
          <h1 class="register-title">Únete a TomateRitmo</h1>
          <p class="register-subtitle">Revoluciona la gestión de tus cultivos con IA</p>
        </div>
      </div>

      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
        <div class="step-header">
          <h3 class="step-title">Crear tu cuenta</h3>
          <p class="step-description">Completa los siguientes campos para registrarte</p>
        </div>

        <div class="form-grid single-column">
          <div class="form-field">
            <label for="email" class="field-label">
              <i class="pi pi-envelope"></i>
              Correo Electrónico
            </label>
            <input
              id="email"
              type="email"
              pInputText
              formControlName="email"
              placeholder="tu@email.com"
              class="form-input"
              [class.input-error]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
            <small class="error-message"
                   *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
              <i class="pi pi-exclamation-circle"></i>
              Ingresa un email válido
            </small>
          </div>

          <div class="form-field">
            <label for="password" class="field-label">
              <i class="pi pi-lock"></i>
              Contraseña
            </label>
            <p-password
              id="password"
              formControlName="password"
              [toggleMask]="true"
              placeholder="Crea una contraseña segura"
              styleClass="w-full password-input"
              inputStyleClass="form-input"
              [class.input-error]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
            </p-password>

            <div class="password-strength" *ngIf="registerForm.get('password')?.value">
              <div class="strength-bar">
                <div class="strength-fill"
                     [style.width.%]="passwordStrength"
                     [style.background-color]="getPasswordStrengthColor()">
                </div>
              </div>
              <span class="strength-text" [style.color]="getPasswordStrengthColor()">
                {{ getPasswordStrengthText() }}
              </span>
            </div>

            <small class="error-message"
                   *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
              <i class="pi pi-exclamation-circle"></i>
              La contraseña debe tener al menos 8 caracteres
            </small>
          </div>

          <div class="form-field">
            <label for="confirmPassword" class="field-label">
              <i class="pi pi-lock"></i>
              Confirmar Contraseña
            </label>
            <p-password
              id="confirmPassword"
              formControlName="confirmPassword"
              [toggleMask]="true"
              [feedback]="false"
              placeholder="Confirma tu contraseña"
              styleClass="w-full password-input"
              inputStyleClass="form-input"
              [class.input-error]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
            </p-password>
            <small class="error-message"
                   *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
              <i class="pi pi-exclamation-circle"></i>
              Las contraseñas no coinciden
            </small>
          </div>

          <div class="form-field terms-field">
            <div class="terms-checkbox">
              <p-checkbox
                id="acceptTerms"
                formControlName="acceptTerms"
                [binary]="true"
                styleClass="custom-checkbox">
              </p-checkbox>
              <label for="acceptTerms" class="terms-label">
                Acepto los
                <a href="#" class="terms-link">Términos y Condiciones</a>
                y la
                <a href="#" class="terms-link">Política de Privacidad</a>
              </label>
            </div>
            <small class="error-message"
                   *ngIf="registerForm.get('acceptTerms')?.invalid && registerForm.get('acceptTerms')?.touched">
              <i class="pi pi-exclamation-circle"></i>
              Debes aceptar los términos y condiciones
            </small>
          </div>
        </div>

        <div class="form-navigation">
          <p-button
            label="Crear Cuenta"
            icon="pi pi-check"
            iconPos="right"
            [loading]="loading"
            type="submit"
            styleClass="nav-button next-button">
          </p-button>
        </div>
      </form>

      <div class="social-section">
        <div class="divider-section">
          <p-divider align="center" type="solid">
            <span class="divider-text">O regístrate con</span>
          </p-divider>
        </div>

        <div class="social-buttons">
          <p-button
            label="Google"
            icon="pi pi-google"
            severity="secondary"
            [outlined]="true"
            (onClick)="loginWithGoogle()"
            styleClass="social-button google-button">
          </p-button>

          <p-button
            label="Facebook"
            icon="pi pi-facebook"
            severity="info"
            [outlined]="true"
            (onClick)="loginWithFacebook()"
            styleClass="social-button facebook-button">
          </p-button>
        </div>
      </div>

      <div class="login-section">
        <p class="login-text">
          ¿Ya tienes una cuenta?
          <a class="login-link" (click)="navigateToLogin()">
            Inicia sesión aquí
          </a>
        </p>
      </div>
    </div>
  </div>
</div>
